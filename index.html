<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CalmPrep</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        :root {
            --primary-blue: #a14f03;
            --bg-gradient: linear-gradient(180deg, #f7c899 0%, #d7995b 100%);
            --ios-glass: rgba(255, 255, 255, 0.4);
        }

        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, "SF Pro Text", "SF Pro Display", system-ui, sans-serif;
            background: var(--bg-gradient);
            height: 100vh;
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
        }

        .screen {
            display: none;
            opacity: 0;
            flex-direction: column;
            align-items: center;
            padding: 44px 20px;
            height: 100vh;
            box-sizing: border-box;
            text-align: center;
        }

        .active {
            display: flex;
            animation: iosFadeUp 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        @keyframes iosFadeUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 { color: white; margin-top: 7%; font-size: 48px; font-weight: 900; letter-spacing: -1px; }
        h2 { color: var(--primary-blue); margin-bottom: 25px; font-size: 38px; font-weight: 700; letter-spacing: -0.5px; }
        h3 { color: #6e470c; margin-bottom: 10px; font-size: 40px; font-weight: 1000; letter-spacing: -0.5px; }
        h4 { color: #915d0f; margin-bottom: 10px; font-size: 20px; font-weight: 700; letter-spacing: -0.5px; }
        p { color: white; font-size: 20px; font-weight: 500; }
        h5 { color: rgb(164, 85, 12); margin-top: 0%; margin-bottom: 5%; font-size: 110px; font-weight: 1000; letter-spacing: -0.1px; line-height: 75%; }

        /* --- UI ELEMENTS --- */
        .menu-btn, .ios-card, .fav-item, .text-input {
            width: 90%;
            background-color: var(--ios-glass);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.05);
            box-sizing: border-box;
        }

        .menu-btn {
            height: 20%;
            padding: 18px;
            margin: 12px 0;
            color: #6e470c;
            font-size: 22px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-tap-highlight-color: transparent;
            text-decoration: none;
        }

        .menu-btn.disabled {
            opacity: 0.6;
            background-color: rgba(0, 0, 0, 0.1);
            color: #555;
            cursor: not-allowed;
            border: none;
        }

        .button-row {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            width: 90%;
            gap: 15px;
            margin-top: 10px;
        }

        /* --- SCROLLING CONTAINER --- */
        .scroll-content {
            width: 100%;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1; 
            padding-bottom: 40px; 
            -webkit-overflow-scrolling: touch; 
        }
        
        .button-row .menu-btn {
            width: 100%;
            margin: 0;
            height: auto;
            padding: 20px;
        }

        .menu-btn2 {
            height: 20%;
            padding: 18px;
            margin: 12px 0;
            color: #c7c7c7;
            font-size: 25px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 90%;
            background-color: rgba(121, 121, 121, 0.422);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(188, 188, 188, 0.3);
            border-radius: 20px;
            box-sizing: border-box;
        }

        .ios-card {
            padding: 30px;
            margin: 20px 0;
            color: #6e470c;
            position: relative;
        }

        /* --- Favorites and Icons --- */
        .like-container {
            width: 90%;
            display: flex;
            justify-content: flex-end;
            margin-top: 10px;
            margin-bottom: 50px;
        }

        .heart-btn {
            font-size: 28px;
            background: var(--ios-glass);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 5px 15px;
            cursor: pointer;
            backdrop-filter: blur(15px);
        }

        #favorites-list {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-y: auto;
            max-height: 70vh;
            padding-bottom: 50px;
        }

        .fav-item {
            font-size: 18px;
            font-weight: 600;
            padding: 20px;
            margin-bottom: 15px;
            background-color: rgba(255, 255, 255, 0.6);
            color: #6e470c;
            text-align: left;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .remove-btn {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            padding: 5px;
        }

        /* --- Interview UI --- */
        .interviewer-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
            background-color: #ddd;
            object-fit: cover;
        }

        .text-input {
            height: auto;
            padding: 20px;
            font-size: 18px;
            color: #6e470c;
            outline: none;
            margin-top: 20px;
            background: rgba(255, 255, 255, 0.8);
        }

        .feedback-msg {
            font-size: 16px;
            font-weight: 700;
            min-height: 24px;
            margin-top: 10px;
            color: white;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .start-btn {
            background-color: var(--primary-blue);
            color: white;
            margin-top: auto;
            margin-bottom: 60px;
            font-size: 19px;
            font-weight: 700;
            height: auto;
            padding: 22px 40px;
            border: none;
        }

        .back-link {
            align-self: flex-start;
            background: none;
            border: none;
            font-size: 17px;
            color: white;
            padding: 10px 0;
            cursor: pointer;
        }

        #breathing-circle {
            width: 180px;
            height: 180px;
            background-color: #fcc37d;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--primary-blue);
            font-weight: 700;
            font-size: 24px;
            margin: 60px 0;
            box-shadow: 0 0 40px rgba(161, 79, 3, 0.3);
        }

        /* --- PLAYER CONTROLS --- */
        .player-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 10px;
        }

        /* --- FIXES FOR STABILITY --- */

        /* Fixed Motivation Quote Box */
        .quote-fixed-box {
            height: 220px; 
            width: 90%; 
            display: flex;
            align-items: center;     
            justify-content: center; 
            overflow-y: auto;      
            margin-bottom: 20px;
            padding: 20px;
            box-sizing: border-box;
        }

        /* Fixed Interview Question Box */
        .interview-fixed-box {
            height: 140px; 
            width: 90%;
            display: flex;
            align-items: center;    
            justify-content: center;
            margin-bottom: 10px;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
        }

        /* Ensure feedback message reserves space so it doesn't jump */
        .feedback-msg {
            height: 30px; 
            margin-top: 10px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes breathe-478 {
            0% { transform: scale(1); }
            21% { transform: scale(1.5); }
            58% { transform: scale(1.5); }
            100% { transform: scale(1); }
        }
    </style>
</head>

<body>

    <audio id="main-player" loop></audio>

    <div id="welcome" class="screen active">
        <h1>Welcome to </h1>
        <h5>Calm<br>Prep</h5>
        <p style="opacity:0.8;">Take your time to relax</p>
        <button class="menu-btn start-btn" onclick="showScreen('home')">Start</button>
    </div>

    <div id="home" class="screen">
        <button class="back-link" onclick="showScreen('welcome')">‚Üê Back</button>
        <h3>Main Menu</h3>
        <h4>Choose your calming method:</h4>
        <button class="menu-btn" onclick="showScreen('breathing')">Breathing Exercises</button>
        <button class="menu-btn" onclick="showScreen('messages')">Motivational Messages</button>
        <button class="menu-btn" onclick="showScreen('music')">Calming Music</button>
        <button class="menu-btn" onclick="showScreen('interview-menu')">Interview Practice</button>
    </div>

    <div id="interview-menu" class="screen">
        <button class="back-link" onclick="showScreen('home')">‚Üê Back</button>
        <h2>Select Profession</h2>
        <button class="menu-btn" onclick="startInterview('cs')">üíª Computer Science</button>
        <button class="menu-btn disabled">üé® Graphic Design üîí</button>
        <button class="menu-btn disabled">üìà Business Mgmt üîí</button>
    </div>

    <div id="interview-room" class="screen">
        <button class="back-link" onclick="quitInterview()">‚Üê Back</button>
        <img src="https://img.freepik.com/free-photo/portrait-white-man-isolated_53876-40306.jpg" alt="Interviewer" class="interviewer-avatar">
        
        <div class="ios-card interview-fixed-box">
            <p id="interviewer-text" style="color:#6e470c; margin:0; font-size:20px; font-weight:600; line-height:1.4;">
                "Hello. Before we begin, what is your name?"
            </p>
        </div>

        <div id="feedback-display" class="feedback-msg">Good job!</div>
        
        <input type="text" id="user-response" class="text-input" style="margin-top: 10px;" placeholder="Type your answer here..." autocomplete="off">
        <button class="menu-btn start-btn" style="margin-top: 20px; width: 100%;" onclick="submitAnswer()">Submit Answer</button>
    </div>

    <div id="interview-result" class="screen">
        <button class="back-link" onclick="showScreen('interview-menu')">‚Üê Back</button>
        <h2 id="result-title" style="margin-top:50px; font-size:36px;">Result</h2>
        <div class="ios-card" id="result-message"></div>
        <button class="menu-btn start-btn" onclick="showScreen('interview-menu')">Done</button>
    </div>

    <div id="breathing" class="screen">
        <button class="back-link" onclick="stopBreathing()">‚Üê Back</button>
        <h2 style="color:white;">4-7-8 Method</h2>
        <div id="breathing-circle">Ready</div>
        <p id="sub-text" style="color:white; font-weight:500;">Focus on your breath.</p>
        
        <button class="menu-btn start-btn" id="breath-start-btn" onclick="startBreath()">Start</button>
        
        <button class="menu-btn start-btn" id="breath-stop-btn" onclick="resetBreathing()" 
                style="display:none;">
            Stop Exercise
        </button>
    </div>

    <div id="messages" class="screen">
        <button class="back-link" onclick="showScreen('home')">‚Üê Back</button>
        <h2>Daily Motivation</h2>
        
        <div id="quote-box" class="ios-card quote-fixed-box">
            <span id="quote-text">"You've prepared for this ‚Äî trust yourself."</span>
        </div>

        <div class="like-container">
            <button class="heart-btn" onclick="toggleFavorite()" id="heart-icon">ü§ç</button>
        </div>
        <div class="button-row">
            <button class="menu-btn" onclick="prevQuote()">Back</button>
            <button class="menu-btn" onclick="nextQuote()">Next</button>
        </div>
        <button class="menu-btn" style="height:auto; padding:15px; margin-top:20px; font-size:18px; opacity:0.9;" onclick="showFavorites()">‚òÖ View Your Favorites</button>
    </div>

    <div id="favorites" class="screen">
        <button class="back-link" onclick="showScreen('messages')">‚Üê Back</button>
        <h2>Your Favorites</h2>
        <div id="favorites-list"></div>
    </div>

    <div id="music" class="screen">
        <button class="back-link" onclick="showScreen('home')">‚Üê Back</button>
        <h2 style="color:white; font-weight: 1000;">Calming Music</h2>
        
            <div class="ios-card" style="margin-bottom: 20px;">
                <p style="margin:0; font-size:12px; font-weight:700; opacity:0.6; text-transform:uppercase;">Now Playing</p>
                <p id="track-title" style="font-size:20px; font-weight:700; margin:12px 0;">No Track Selected</p>
                
                <div class="player-row">
                    <button onclick="togglePlay()" id="play-pause-btn" style="width:54px; height:54px; border-radius:50%; display:flex; align-items:center; justify-content:center; background: white; border:none; cursor:pointer; font-size: 24px;">‚ñ∂</button>
                    <button onclick="stopMusic()" class="control-btn" style="width:54px; height:54px; border-radius:50%; display:flex; align-items:center; justify-content:center; background: white; border:none; cursor:pointer; font-size: 24px;">‚èπ</button>
                    <button onclick="playRandom()" id="shuffle-btn" style="width:54px; height:54px; border-radius:50%; display:flex; align-items:center; justify-content:center; background: white; border:none; cursor:pointer; font-size: 24px;">üîÄ</button>
                </div>
            </div>
            <!-- <button onclick="playRandom()" id="shuffle-btn" sttyle="width:54px; height:54px; border-radius:50%; display:flex; align-items:center; justify-content:center; background: white; border:none; cursor:pointer; font-size: 24px;">üîÄ</button> -->
        <div class="scroll-content">
            <button class="menu-btn" onclick="playTrack('mysong1.mp3', 'Parfum detoiles')">Parfum detoiles</button>
            <button class="menu-btn" onclick="playTrack('mysong2.mp3', 'Marginalia #65')">Marginalia</button>
            <button class="menu-btn" onclick="playTrack('mysong3.mp3', 'Easy Lovers')">Easy Lovers</button>
            <button class="menu-btn" onclick="playTrack('mysong4.mp3', 'Wyoming')">Wyoming</button>
            <button class="menu-btn" style="color:rgba(110, 71, 12, 0.5);">More coming soon...</button>
        </div>
    </div>

    <script>
        const player = document.getElementById('main-player');
        const playBtn = document.getElementById('play-pause-btn');

        // --- DATA ---
        const quotes = [
            "You are prepared.",
            "Deep breaths.",
            "Trust yourself.",
            "You've got this.",
            "You have done the work. Now, let the results take care of themselves.",
            "A single interview does not define your worth or your future.",
            "Exhale the pressure. Inhale the possibility.",
            "You are more than enough, exactly as you are in this moment.",
            "Think of the interview as a conversation, not an interrogation.",
            "Your only job right now is to be present and be yourself.",
            "Even if you feel nervous, you are still capable of doing a great job.",
            "Focus on how far you've come, not just where you're going.",
            "It is okay to take a moment to think before you speak.",
            "You belong in the room where these conversations are happening.",
            "One step at a time. One breath at a time. You are doing great.",
            "Your preparation has built a foundation. Trust it to support you.",
            "You are not just being interviewed; you are also seeing if they are right for you.",
            "Release the need for perfection. Authenticity is what connects people.",
            "This is just one chapter. You are the author of the whole book.",
            "Quiet the 'what-ifs' and listen to your 'I can.'",
            "The world needs exactly what you have to offer."
        ];

        let quoteHistory = [];
        let historyIndex = -1;
        let favorites = [];

        // --- INTERVIEW LOGIC ---
        let interviewState = 'naming';
        let userName = '';
        let currentQuestionIndex = 0;
        let interviewScore = 0;
        let currentInterviewQuestions = [];

        const masterQuestionBank = [
            { q: "What data type is used for 'true' or 'false' values?", a: "boolean" },
            { q: "What does HTML stand for?", a: "hypertext markup language" },
            { q: "Which keyword indicates a method returns nothing in Java?", a: "void" }, 
            { q: "What is 10 modulo 3?", a: "1" },
            { q: "Which keyword is used to create a new object instance?", a: "new" },    
            { q: "What does CSS stand for?", a: "cascading style sheets" },
            { q: "What is the time complexity of looking up an item in a hash map?", a: "O(1)" }, //
            { q: "What is the name of the entry point method in Java?", a: "main" },      
            { q: "Which SQL command retrieves data?", a: "select" },
            { q: "What is the binary representation of 2?", a: "10" },
            { q: "Arrays in most languages start at which index?", a: "0" },
            { q: "Which data structure follows LIFO (Last In First Out)?", a: "stack" }
        ];

        function startInterview(jobType) {
            if (jobType !== 'cs') return;
            interviewState = 'naming';
            userName = '';
            currentQuestionIndex = 0;
            interviewScore = 0;
            const shuffled = [...masterQuestionBank].sort(() => 0.5 - Math.random());
            currentInterviewQuestions = shuffled.slice(0, 4);

            document.getElementById('interviewer-text').innerText = "Hello. Before we begin, what is your name?";
            document.getElementById('user-response').value = "";
            document.getElementById('user-response').placeholder = "Enter your name...";
            document.getElementById('feedback-display').style.opacity = 0;
            showScreen('interview-room');
        }

        function submitAnswer() {
            const inputField = document.getElementById('user-response');
            const userText = inputField.value.trim();
            const textBox = document.getElementById('interviewer-text');
            const feedback = document.getElementById('feedback-display');

            if (userText === "") return;

            if (interviewState === 'naming') {
                userName = userText;
                interviewState = 'questioning';
                inputField.value = "";
                inputField.placeholder = "Type your answer...";
                textBox.innerText = `${userName}, ${currentInterviewQuestions[0].q}`;
            } else if (interviewState === 'questioning') {
                const currentQ = currentInterviewQuestions[currentQuestionIndex];
                const isCorrect = userText.toLowerCase().includes(currentQ.a);

                feedback.style.opacity = 1;
                if (isCorrect) {
                    interviewScore++;
                    feedback.innerText = "Good job, let's continue.";
                    feedback.style.color = "#dcfce7";
                } else {
                    feedback.innerText = "Mhm okay, let's continue.";
                    feedback.style.color = "#fee2e2";
                }

                setTimeout(() => {
                    feedback.style.opacity = 0;
                    currentQuestionIndex++;
                    inputField.value = "";

                    if (currentQuestionIndex < currentInterviewQuestions.length) {
                        textBox.innerText = `${userName}, ${currentInterviewQuestions[currentQuestionIndex].q}`;
                    } else {
                        finishInterview();
                    }
                }, 1500);
            }
        }

        function finishInterview() {
            showScreen('interview-result');
            const resultTitle = document.getElementById('result-title');
            const resultMsg = document.getElementById('result-message');
            if (interviewScore >= 3) {
                resultTitle.innerText = "Congratulations! üéâ";
                resultMsg.innerHTML = `<h3>You're Hired!</h3><p style="color:#6e470c">Great work, ${userName}. You answered ${interviewScore}/4 questions correctly.</p>`;
            } else {
                resultTitle.innerText = "Interview Complete";
                resultMsg.innerHTML = `<h3>Don't give up!</h3><p style="color:#6e470c">You got ${interviewScore}/4 correct. Review your basics and try again, ${userName}!</p>`;
            }
        }

        function quitInterview() {
            showScreen('interview-menu');
        }

        // --- NAVIGATION & QUOTES ---
        window.onload = function() { nextQuote(); };

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function nextQuote() {
            if (historyIndex < quoteHistory.length - 1) {
                historyIndex++;
                displayQuote(quoteHistory[historyIndex]);
            } else {
                const randomQ = quotes[Math.floor(Math.random() * quotes.length)];
                quoteHistory.push(randomQ);
                historyIndex++;
                displayQuote(randomQ);
            }
        }

        function prevQuote() {
            if (historyIndex > 0) {
                historyIndex--;
                displayQuote(quoteHistory[historyIndex]);
            }
        }

        function displayQuote(text) {
            document.getElementById('quote-text').innerText = text;
            updateHeartIcon(text);
        }

        function toggleFavorite() {
            const currentText = document.getElementById('quote-text').innerText;
            const index = favorites.indexOf(currentText);
            if (index === -1) favorites.push(currentText);
            else favorites.splice(index, 1);
            updateHeartIcon(currentText);
        }

        function updateHeartIcon(text) {
            document.getElementById('heart-icon').innerText = favorites.includes(text) ? "‚ù§Ô∏è" : "ü§ç";
        }

        function removeFavorite(quote) {
            favorites = favorites.filter(f => f !== quote);
            showFavorites();
            updateHeartIcon(document.getElementById('quote-text').innerText);
        }

        function showFavorites() {
            showScreen('favorites');
            const list = document.getElementById('favorites-list');
            list.innerHTML = "";
            if (favorites.length === 0) {
                list.innerHTML = '<p style="margin-top:50px; opacity:0.7;">No favorites saved yet.<br>Tap the ü§ç to save.</p>';
                return;
            }
            favorites.forEach(fav => {
                const item = document.createElement('div');
                item.className = 'fav-item';
                item.innerHTML = `<span>${fav}</span> <button class="remove-btn" onclick="removeFavorite('${fav.replace(/'/g, "\\'")}')">üóëÔ∏è</button>`;
                list.appendChild(item);
            });
        }

        // --- BREATHING & MUSIC ---
        let breathInterval;

        function startBreath() {
            const circle = document.getElementById('breathing-circle');
            const startBtn = document.getElementById('breath-start-btn');
            const stopBtn = document.getElementById('breath-stop-btn');
            
            // Swap buttons
            startBtn.style.display = "none";
            stopBtn.style.display = "flex"; // Show the stop button
            
            // Start Animation
            circle.style.animation = "breathe-478 19s infinite linear";
            updateBreathText();
            breathInterval = setInterval(updateBreathText, 19000);
        }

        function updateBreathText() {
            const circleText = document.getElementById('breathing-circle');
            circleText.innerText = "Inhale";
            setTimeout(() => { circleText.innerText = "Hold"; }, 4000);
            setTimeout(() => { circleText.innerText = "Exhale"; }, 11000);
        }

        // New function: Stops the animation but stays on the screen
        function resetBreathing() {
            const circle = document.getElementById('breathing-circle');
            const startBtn = document.getElementById('breath-start-btn');
            const stopBtn = document.getElementById('breath-stop-btn');

            circle.style.animation = "none";
            circle.innerText = "Ready";
            
            // Swap buttons back
            startBtn.style.display = "flex"; // Show start
            stopBtn.style.display = "none";  // Hide stop
            
            clearInterval(breathInterval);
        }

        // Existing function: Stops animation AND goes back to menu
        function stopBreathing() {
            resetBreathing(); // Stop the logic
            showScreen('home'); // Go back
        }

        function playTrack(url, title) {
            player.src = url;
            player.play();
            document.getElementById('track-title').innerText = title;
            playBtn.innerText = "‚è∏";
        }

        function togglePlay() {
            if (!player.src) return;
            if (player.paused) { player.play(); playBtn.innerText = "‚è∏"; }
            else { player.pause(); playBtn.innerText = "‚ñ∂"; }
        }

        function stopMusic() {
            player.pause();
            player.src = "";
            document.getElementById('track-title').innerText = "No Track Selected";
            playBtn.innerText = "‚ñ∂";
        }

        function playRandom() {
            const playlist = [
                { url: 'mysong1.mp3', title: 'Parfum detoiles' },
                { url: 'mysong2.mp3', title: 'Marginalia' },
                { url: 'mysong3.mp3', title: 'Easy Lovers' },
                { url: 'mysong4.mp3', title: 'Wyoming' }
            ];

            const randomIndex = Math.floor(Math.random() * playlist.length);
            const selectedSong = playlist[randomIndex];

            playTrack(selectedSong.url, selectedSong.title);
        }
    </script>
</body>

</html>
